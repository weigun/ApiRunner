config:
  name: signup testcase
  host: "{{$base_url}}"
  variables:
    g_email: "{{gen_email}}"
    base_url: http://depay.ixbow.com/

func:
  email: $g_email
  password: 111111

return: 
  emails: "@email"
  tokens: "@tokens"


apis:
  - name: email-normal
    extends: testcase\btree.yaml
    ref: normal
    validate:
      - op: eq
        actual: "{{.body.msg}}"
        expected: ok
      - op: eq
        actual: "{{.body.email}}"
        expected: "{{$mymail}}"
      - op: eq
        actual: "{{.body.code}}"
        expected: 0

  - name: email-empty
    extends: testcase\btree.yaml
    ref: empty
    when: 
      error: 
        maxtry: 3
        callback: "{{print request}}"
      failed: 
        maxtry: 1
      success:  
        callback: "{{print request}}"

    func: 
      email: ""

    validate:
      - op: eq
        actual: "{{.body.code}}"
        expected: 1
  - name: recharge
    import: testcase\btree.yaml
    func:
      amount: 100
    return:
      orderId: "{{.body.data}}"

